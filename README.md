# AWS-Lambda-Python-Example

AWS Lambda for Python Examples

---

Detect News Titles From GoogleNews

## Setup

```bash
$ pyenv install 2.7.9

or 

$ cd ~/.pyenv
$ git pull origin master
$ pyenv install 2.7.9
```

```
$ pyenv virtualenv 2.7.9 aws-lambda-example
$ pyenv local aws-lambda-example
```

## Development
```bash
$ mkdir -p ~/path/to/repo/AWS-Lambda-Python-Example
$ cd ~/path/to/repo/AWS-Lambda-Python-Example
$ pip install beautifulsoup4 -t . 
$ vi main.py
```

```python
import urllib2
from bs4 import BeautifulSoup

print("load function")

SCRAPING_URL = "https://news.google.com/"
USER_AGENT = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36"


def lambda_handler(event, context):
    request = urllib2.Request(SCRAPING_URL)
    request.add_header('User-agent', USER_AGENT)

    html = urllib2.urlopen(request).read()
    bs = BeautifulSoup(html)

    print("finish function")
    return [x.text for x in bs.find_all(class_="titletext")]
```

## Upload 
```bash
$ pwd
$ /Users/teitei/path/to/repo/AWS-Lambda-Python-Example
$ zip -r AWS-Lambda-Python.zip *
$ aws lambda create-function --region us-west-2 --function-name main --zip-file fileb://AWS-Lambda-Python-Example.zip --role arn:aws:iam::0000000:role/lambda_basic_execution --handler main.lambda_handler --runtime python2.7 --timeout 15 --memory-size 12
```

## result
```
[
  "組み体操で骨折、１０年で２０人 大阪・八尾の中学校",
  "骨折多すぎ！過去１０年で１３９人 組み体操事故で調査結果を報告 八尾市教委",
  "組み体操事故：大阪府八尾市１０年で３６校１３９人骨折",
  "組み体操、１０年で骨折１３９人",
  "マツダが９２万台リコール ２１車種、発煙や発火の恐れ",
  "ハンドル付近から出火の恐れ…マツダがリコール",
  "マツダ、デミオなど９２万台リコール＝スイッチ不具合、火災１３件—国交省改善指示",
  "元近鉄の投手、盛田幸妃さん死去 脳腫瘍から復帰し登板",
  "「奇跡のリリーバー」盛田幸妃氏が４５歳で死去 大洋、近鉄などで活躍",
  "脳腫瘍乗り越えた「奇跡のリリーバー」盛田幸妃氏死去",
  "設備投資拡大、官民ですれ違い 企業「規制緩和先決」",
  "「一歩踏み込んだ投資を」 官民対話が初会合 異例の政治主導で景気回復軌道へ",
  "設備投資拡大へ課題＝計画・実行にギャップ—官民対話",
  "「踏み込んだ投資拡大を」 首相、官民対話で要請",
  "官民対話：安倍首相、経済界に積極投資を要請",
  "習主席、７千万人以上の貧困人口「５年で脱却」",
  "貧困撲滅に中国の経験生かす 習主席、胸張り強調",
  "習近平主席、貧困撲滅と発展フォーラムで講演",
  "どうなる国連改革、日本が安保理の非常任理事国に",
  "国連安保理：北朝鮮問題取り組む 非常任理入り、吉川大使が意欲",
  "岸田外相、非常任理事国選出で安保理改革に意欲",
  "日本、非常任理事国入り 国連総会で選出",
  "石綿含む煙突の断熱材、学校など380機関で劣化 文科省調査",
  "１９３校で石綿含む断熱材劣化、吸い込むおそれ 2015年10月16日 22時55分",
  "学校対策進まない自治体 「壊さなければ大丈夫」との声も 煙突のアスベスト飛散",
  "部下の腹に銃口、警部補を停職３か月…書類送検 2015年10月16日 19時54分",
  "部下の腹に拳銃押しつけた疑い、警部補を書類送検 群馬",
  "懲戒処分：群馬県警警部補が部下の腹部に拳銃押しつけ",
  "部下に拳銃押し付け容疑",
  "強姦事件の再審、男性に無罪判決…大阪地裁 2015年10月16日 21時26分",
  "強姦事件再審、男性に無罪判決 地裁「自由を奪い残念」",
  "再審：強姦証言はうそ…裁判長「誠に残念」無罪判決",
  "逮捕報道の削除訴訟、グーグル側が争う姿勢",
  "逮捕報道の検索結果削除請求 口頭弁論でグーグル側争う姿勢",
  "グーグル「知る権利著しく損ねる」と争う姿勢 検索結果削除訴訟",
  "米軍：アフガン完全撤退断念 １７年以降も５５００人駐留",
  "オバマ氏の対テロ戦略行き詰まり アフガン撤収断念で",
  "米駐留延長、オバマ氏の決断歓迎…アフガン政府 2015年10月16日 13時57分",
  "アフガン16年末撤退断念 米軍５５００人残留方針",
  "ブルガリア国境警察の警告射撃で死者 アフガン難民か",
  "アフガン難民に発砲、１人死亡 ブルガリア",
  "ブルガリア国境警備隊が難民に発砲、１人死亡",
  "アフガン難民男性、ブルガリア国境警察の威嚇射撃で死亡",
  "中国、シリアでの武力行使に反対の立場を改めて表明",
  "パンナム機爆破、新たに容疑者２人を特定",
  "パンナム機爆破 新たに容疑者２人特定",
  "パンナム機爆破事件で新容疑者元リビア情報機関トップら２人",
  "日産と三菱、軽のＥＶも共同開発へ 設計・調達は日産",
  "日産と三菱、３台目の軽自動車開発へ 設計開発は日産",
  "日産と三菱自、提携関係継続…次期型の軽を開発 2015年10月16日 22時22分",
  "軽の次期モデルも協業継続、生産は三菱のまま 日産が設計開発",
  "英利上げ、割合早い時期となる＝フォーブス中銀委員",
  "利上げ「遅いよりは早い時期に実施」 - 英中銀のフォーブス氏",
  "ゆうちょ銀、かんぽ生命ＩＰＯ:売り出し価格は上限寄りに－関係者(1)",
  "『元祖女性株式評論家』木村佳子が解説する「日本郵政３社上場」のポイント(2)",
  "ゆうちょ・かんぽの限度額、上場前の引き上げ困難に",
  "郵政３銘柄、需要堅調で５倍超 高配当利回り・「かんぽの宿」が呼び水に",
  "8月のユーロ圏貿易黒字、112億ユーロに拡大",
  "馳文科相、県の補助金受けた会社からの寄付返金 2015年10月16日 22時22分",
  "馳氏の自民支部に補助金企業献金 ２９万、法抵触の可能性も",
  "北極に関する初の基本政策決定 国際ルール作りで主導",
  "氷溶け資源豊富な北極、政府が初の基本政策決定 2015年10月16日 20時46分",
  "北極開発「日本が主導的役割」 政府が初の基本方針",
  "政府、北極で初の基本政策 総合海洋本部で１６日に決定",
  "ＩｏＴ促進へ専用携帯番号＝「０２０」割り当て－総務省",
  "ＴＰＰ：「国会承認案の処理は春以降」自民・谷垣幹事長",
  "ＴＰＰ処理は１６年度予算成立後の見通し",
  "自民幹事長、臨時国会開催「もう少し精査」",
  "『灰と幻想のグリムガル』のTVアニメ化が決定! 2016年1月より放送開始",
  "オーバーラップ文庫の『灰と幻想のグリムガル』TVアニメ化決定",
  "ラノベ『灰と幻想のグリムガル』16年1月TVアニメ化 制作はA-1",
  "熊倉一雄さん死去 「ひょうたん島」トラヒゲの声も",
  "鬼太郎の歌 熊倉一雄さん死去",
  "俳優で演出家の熊倉一雄氏が死去",
  "今井さんが残した映画を親友の川平が主演",
  "今井雅之さん遺作舞台が映画化",
  "『手をつないでかえろうよ』映画制作発表会開催“生のエネルギーと輪廻”をテーマに人気舞台を映画化、来年5月ロードショー",
  "「楽しく行きまっせ！」DISH//のTo-i、祝福と笑顔あふれた成人記念日",
  "「ＤＩＳＨ／／」Ｔｏ―ｉ２０歳生誕祭「汗が止まらない」",
  "ヤクルト、２戦連続で巨人に完封勝ち! 日本Ｓ進出に王手",
  "ヤクルト、日本Ｓ出場王手！６回４安打の館山から５投手で完封リレー",
  "【巨人】崖っぷち！菅野また神宮で勝てず",
  "ソフトＢ、日本シリーズ進出",
  "【プロ野球】ヤクルトが巨人に２－０で勝利 シリーズ進出に王手！",
  "【ソフトＢ】２年連続日本Ｓ進出！無傷の３連勝！！",
  "ソフトバンクが日本Ｓ進出、工藤監督９度舞った",
  "ソフトＢ３タテ２年連続日本シリーズ",
  "バレンティン死球で菅野とにらみ合い",
  "燕・バレンティン、死球受けマウンド上の菅野に詰め寄る",
  "【ヤクルト】バレンティン、菅野の死球に怒り露わ",
  "京大医学部病院：肝臓に直接手術部位投影するシステム開発",
  "がん切除、映像投影で正確に 京大など装置開発",
  "臓器に立体映像投影する装置開発 手術の安全性向上、京大",
  "受賞決まった梶田さん、久々に妻と再会 富山市に帰る",
  "梶田氏に栄誉大賞を検討 ノーベル賞たたえ、岐阜県",
  "ノーベル賞：梶田さん受賞決定から１０日 やっと妻と再会",
  "【レポート】JVC、名刺サイズのウッドコーンスピーカー - 音展 2015に参考出品",
  "＜音展＞JVCケンウッド、名刺サイズの超小型ウッドコーンや“人工熟成”スピーカー参考出展",
  "JVC、名刺サイズのウッドコーンスピーカー - 音展 2015に参考出品",
  "ゲーム実況アプリ「YouTube Gaming」、「Android」端末から実況が可能に",
  "YouTube Gaming、Android端末でのゲーム実況が可能に",
  "YouTube Gamingがモバイルからの直接ストリーミングをサポート、Twitch的機能を一層充実",
  "英利上げ、割合早い時期となる＝フォーブス中銀委員",
  "ユーロ圏、成長促進に向け統合深化の必要＝ＥＣＢ専務理事",
  "東北新幹線トンネル内、計７キロのモルタル片が落下",
  "カボチャごみ袋を東京都が無料配布 ハロウィーンに合わせ３０万枚",
  "東京都・銀座で資生堂による「美の大実験室 展」- \"ガムの茶道\"などを展示",
  "東京都世田谷の「肉屋カーニバル」などがカラスを使ったジビエ料理を提供",
  "文科相献金232万円返金",
  "マンション傾斜 セメント量改ざん",
  "PC使えぬ若者増加",
  "USJ 不正転売チケットは無効に",
  "球児と不適切なやりとり 審判処分",
  "実名！中国経済「30人の証言」 日系企業が次々撤退、大失速の真相～こんなに異変が起きていた",
  "中国ビジネスで生き残るための5つの鉄則",
  "【北斗晶・乳がん告白】マンモグラフィー推奨は４０歳以上 ２０～３０代には「不利益」も",
  "マルタイ棒ラーメン、アジアの胃袋つかむ 社長も感激",
  "怒りをこらえられない韓国人、人格・行動障害の受診者急増",
  "フジテレビに弄ばれて解散のアイドリング!!!、売れなくなったアイドルに風俗業界が“愛の手”を差し伸べる？",
  "朝ドラ現場で宮崎あおいと寺島しのぶが「女優魂ぶつけ合い」",
  "嵐・大野智“お気に入り”のベテランJr.が「退所」!? 公式サイトから削除でファン悲鳴",
  "安倍新内閣、実はココがすごい〜永田町のプロ筋が高評価する理由",
  "元銀行係長が１・４億着服、妻に手紙残し不明に",
  "原作ではもっと可哀想な姉はつ「あさが来た」11話",
  "【世界記憶遺産】「大虐殺」は虚偽や疑問点だらけ 「反日プロパガンダ」に憤る声も",
  "強姦事件の再審、男性に無罪判決…大阪地裁 2015年10月16日 21時26分",
  "マツダ：９２万３６７２台リコール 出火恐れ把握１０年超",
  "田中邦衛 「老人ホーム入居」で妻・娘と歩む「復帰への道」",
  "逮捕報道の削除訴訟、グーグル側が争う姿勢",
  "元近鉄の投手、盛田幸妃さん死去 脳腫瘍から復帰し登板"
]
```
